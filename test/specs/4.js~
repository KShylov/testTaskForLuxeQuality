import { assert } from 'chai'
import LoginPage from '../pageobjects/login.page.js'
import InventoryPage from "../pageobjects/inventory.page.js";
import {JsonReader} from "../../utils/JsonReader.js";
import {filePathResolver} from "../../utils/FilePathResolver.js";

describe('Login', () => {
    const filePath = filePathResolver.getFilePath('testData.json');
    const testData = JsonReader.readJson(filePath);
    before(async () => {
        await LoginPage.open();
        await LoginPage.login(testData.users.standard_user, testData.password);
    })

    it('Logout', async () => {
        console.log("step1 Click on the \"Burger\" button at the top left corner");
        await InventoryPage.burgerButton.click();
        await assert.isTrue(await InventoryPage.menu.isDisplayed(), "Menu are expanded");
        await assert.equal(await InventoryPage.menuItems.length, 4, "4 items are displayed");

        console.log("step1 Click on the \"Logout\" button")
        await InventoryPage.logoutButton.click();
        let actualdata = {
            url: await browser.getUrl(),
            username: await LoginPage.inputUsername.getValue(),
            password: await LoginPage.inputPassword.getValue()
        }
        const expectedData = {
            url: 'https://www.saucedemo.com/',
            username: '',
            password: ''
        }
        await assert.deepEqual(actualdata, expectedData, "The data is not correct");
    })
})

